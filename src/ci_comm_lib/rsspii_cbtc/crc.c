/******************************************************************************
** 项目名称：客运专线列控系统临时限速服务器
** 版权信息：Copyright (c) 2010-2015，Beijing Jiaoda Microunion Tech Co.,LTD.
** 文件名称：crc.c 版本号：V0.0.0
** 创建人：                          创建日期：2010.11.23
** 功能摘要：
** 参考文献：
*******************************************************************************
** 修改日期：
** 修改内容：
******************************************************************************/
#include "crc.h"
#include <string.h>


/* CCITT-CRC16: x16+x12+x5+1 */
/* 高位在前 */
WORD crc16_ccitt_tableH[256]={                   /*%RELAX<MISRA_8_10>*/   /*%RELAX<MISRA_8_7>*/
	0x0000, 0x1021, 0x2042, 0x3063, 0x4084, 0x50a5, 0x60c6, 0x70e7,
	0x8108, 0x9129, 0xa14a, 0xb16b, 0xc18c, 0xd1ad, 0xe1ce, 0xf1ef,
	0x1231, 0x0210, 0x3273, 0x2252, 0x52b5, 0x4294, 0x72f7, 0x62d6,
	0x9339, 0x8318, 0xb37b, 0xa35a, 0xd3bd, 0xc39c, 0xf3ff, 0xe3de,
	0x2462, 0x3443, 0x0420, 0x1401, 0x64e6, 0x74c7, 0x44a4, 0x5485,
	0xa56a, 0xb54b, 0x8528, 0x9509, 0xe5ee, 0xf5cf, 0xc5ac, 0xd58d,
	0x3653, 0x2672, 0x1611, 0x0630, 0x76d7, 0x66f6, 0x5695, 0x46b4,
	0xb75b, 0xa77a, 0x9719, 0x8738, 0xf7df, 0xe7fe, 0xd79d, 0xc7bc,
	0x48c4, 0x58e5, 0x6886, 0x78a7, 0x0840, 0x1861, 0x2802, 0x3823,
	0xc9cc, 0xd9ed, 0xe98e, 0xf9af, 0x8948, 0x9969, 0xa90a, 0xb92b,
	0x5af5, 0x4ad4, 0x7ab7, 0x6a96, 0x1a71, 0x0a50, 0x3a33, 0x2a12,
	0xdbfd, 0xcbdc, 0xfbbf, 0xeb9e, 0x9b79, 0x8b58, 0xbb3b, 0xab1a,
	0x6ca6, 0x7c87, 0x4ce4, 0x5cc5, 0x2c22, 0x3c03, 0x0c60, 0x1c41,
	0xedae, 0xfd8f, 0xcdec, 0xddcd, 0xad2a, 0xbd0b, 0x8d68, 0x9d49,
	0x7e97, 0x6eb6, 0x5ed5, 0x4ef4, 0x3e13, 0x2e32, 0x1e51, 0x0e70,
	0xff9f, 0xefbe, 0xdfdd, 0xcffc, 0xbf1b, 0xaf3a, 0x9f59, 0x8f78,
	0x9188, 0x81a9, 0xb1ca, 0xa1eb, 0xd10c, 0xc12d, 0xf14e, 0xe16f,
	0x1080, 0x00a1, 0x30c2, 0x20e3, 0x5004, 0x4025, 0x7046, 0x6067,
	0x83b9, 0x9398, 0xa3fb, 0xb3da, 0xc33d, 0xd31c, 0xe37f, 0xf35e,
	0x02b1, 0x1290, 0x22f3, 0x32d2, 0x4235, 0x5214, 0x6277, 0x7256,
	0xb5ea, 0xa5cb, 0x95a8, 0x8589, 0xf56e, 0xe54f, 0xd52c, 0xc50d,
	0x34e2, 0x24c3, 0x14a0, 0x0481, 0x7466, 0x6447, 0x5424, 0x4405,
	0xa7db, 0xb7fa, 0x8799, 0x97b8, 0xe75f, 0xf77e, 0xc71d, 0xd73c,
	0x26d3, 0x36f2, 0x0691, 0x16b0, 0x6657, 0x7676, 0x4615, 0x5634,
	0xd94c, 0xc96d, 0xf90e, 0xe92f, 0x99c8, 0x89e9, 0xb98a, 0xa9ab,
	0x5844, 0x4865, 0x7806, 0x6827, 0x18c0, 0x08e1, 0x3882, 0x28a3,
	0xcb7d, 0xdb5c, 0xeb3f, 0xfb1e, 0x8bf9, 0x9bd8, 0xabbb, 0xbb9a,
	0x4a75, 0x5a54, 0x6a37, 0x7a16, 0x0af1, 0x1ad0, 0x2ab3, 0x3a92,
	0xfd2e, 0xed0f, 0xdd6c, 0xcd4d, 0xbdaa, 0xad8b, 0x9de8, 0x8dc9,
	0x7c26, 0x6c07, 0x5c64, 0x4c45, 0x3ca2, 0x2c83, 0x1ce0, 0x0cc1,
	0xef1f, 0xff3e, 0xcf5d, 0xdf7c, 0xaf9b, 0xbfba, 0x8fd9, 0x9ff8,
	0x6e17, 0x7e36, 0x4e55, 0x5e74, 0x2e93, 0x3eb2, 0x0ed1, 0x1ef0
};
#if 0
/* 低位在前 */
/* 显然: 0x01相当于高位在前的 0x80 */
/* 上面表中 0x80对应的crc是0x9188(这个数是高位在前), 再把位顺序颠倒,得到本表的0x01的crc值: 0x1189 */
WORD crc16_ccitt_tableL[256] =
{
	0x0000, 0x1189, 0x2312, 0x329b, 0x4624, 0x57ad, 0x6536, 0x74bf,
	0x8c48, 0x9dc1, 0xaf5a, 0xbed3, 0xca6c, 0xdbe5, 0xe97e, 0xf8f7,
	0x1081, 0x0108, 0x3393, 0x221a, 0x56a5, 0x472c, 0x75b7, 0x643e,
	0x9cc9, 0x8d40, 0xbfdb, 0xae52, 0xdaed, 0xcb64, 0xf9ff, 0xe876,
	0x2102, 0x308b, 0x0210, 0x1399, 0x6726, 0x76af, 0x4434, 0x55bd,
	0xad4a, 0xbcc3, 0x8e58, 0x9fd1, 0xeb6e, 0xfae7, 0xc87c, 0xd9f5,
	0x3183, 0x200a, 0x1291, 0x0318, 0x77a7, 0x662e, 0x54b5, 0x453c,
	0xbdcb, 0xac42, 0x9ed9, 0x8f50, 0xfbef, 0xea66, 0xd8fd, 0xc974,
	0x4204, 0x538d, 0x6116, 0x709f, 0x0420, 0x15a9, 0x2732, 0x36bb,
	0xce4c, 0xdfc5, 0xed5e, 0xfcd7, 0x8868, 0x99e1, 0xab7a, 0xbaf3,
	0x5285, 0x430c, 0x7197, 0x601e, 0x14a1, 0x0528, 0x37b3, 0x263a,
	0xdecd, 0xcf44, 0xfddf, 0xec56, 0x98e9, 0x8960, 0xbbfb, 0xaa72,
	0x6306, 0x728f, 0x4014, 0x519d, 0x2522, 0x34ab, 0x0630, 0x17b9,
	0xef4e, 0xfec7, 0xcc5c, 0xddd5, 0xa96a, 0xb8e3, 0x8a78, 0x9bf1,
	0x7387, 0x620e, 0x5095, 0x411c, 0x35a3, 0x242a, 0x16b1, 0x0738,
	0xffcf, 0xee46, 0xdcdd, 0xcd54, 0xb9eb, 0xa862, 0x9af9, 0x8b70,
	0x8408, 0x9581, 0xa71a, 0xb693, 0xc22c, 0xd3a5, 0xe13e, 0xf0b7,
	0x0840, 0x19c9, 0x2b52, 0x3adb, 0x4e64, 0x5fed, 0x6d76, 0x7cff,
	0x9489, 0x8500, 0xb79b, 0xa612, 0xd2ad, 0xc324, 0xf1bf, 0xe036,
	0x18c1, 0x0948, 0x3bd3, 0x2a5a, 0x5ee5, 0x4f6c, 0x7df7, 0x6c7e,
	0xa50a, 0xb483, 0x8618, 0x9791, 0xe32e, 0xf2a7, 0xc03c, 0xd1b5,
	0x2942, 0x38cb, 0x0a50, 0x1bd9, 0x6f66, 0x7eef, 0x4c74, 0x5dfd,
	0xb58b, 0xa402, 0x9699, 0x8710, 0xf3af, 0xe226, 0xd0bd, 0xc134,
	0x39c3, 0x284a, 0x1ad1, 0x0b58, 0x7fe7, 0x6e6e, 0x5cf5, 0x4d7c,
	0xc60c, 0xd785, 0xe51e, 0xf497, 0x8028, 0x91a1, 0xa33a, 0xb2b3,
	0x4a44, 0x5bcd, 0x6956, 0x78df, 0x0c60, 0x1de9, 0x2f72, 0x3efb,
	0xd68d, 0xc704, 0xf59f, 0xe416, 0x90a9, 0x8120, 0xb3bb, 0xa232,
	0x5ac5, 0x4b4c, 0x79d7, 0x685e, 0x1ce1, 0x0d68, 0x3ff3, 0x2e7a,
	0xe70e, 0xf687, 0xc41c, 0xd595, 0xa12a, 0xb0a3, 0x8238, 0x93b1,
	0x6b46, 0x7acf, 0x4854, 0x59dd, 0x2d62, 0x3ceb, 0x0e70, 0x1ff9,
	0xf78f, 0xe606, 0xd49d, 0xc514, 0xb1ab, 0xa022, 0x92b9, 0x8330,
	0x7bc7, 0x6a4e, 0x58d5, 0x495c, 0x3de3, 0x2c6a, 0x1ef1, 0x0f78
};



/*CRC16-CCITT x16+x12+x5+1 1021 ISO HDLC, ITU X.25, V.34/V.41/V.42, PPP-FCS*/
static const WORD crc16_ccitt_table[256] =
{
	0x0000, 0x1189, 0x2312, 0x329b, 0x4624, 0x57ad, 0x6536, 0x74bf,
	0x8c48, 0x9dc1, 0xaf5a, 0xbed3, 0xca6c, 0xdbe5, 0xe97e, 0xf8f7,
	0x1081, 0x0108, 0x3393, 0x221a, 0x56a5, 0x472c, 0x75b7, 0x643e,
	0x9cc9, 0x8d40, 0xbfdb, 0xae52, 0xdaed, 0xcb64, 0xf9ff, 0xe876,
	0x2102, 0x308b, 0x0210, 0x1399, 0x6726, 0x76af, 0x4434, 0x55bd,
	0xad4a, 0xbcc3, 0x8e58, 0x9fd1, 0xeb6e, 0xfae7, 0xc87c, 0xd9f5,
	0x3183, 0x200a, 0x1291, 0x0318, 0x77a7, 0x662e, 0x54b5, 0x453c,
	0xbdcb, 0xac42, 0x9ed9, 0x8f50, 0xfbef, 0xea66, 0xd8fd, 0xc974,
	0x4204, 0x538d, 0x6116, 0x709f, 0x0420, 0x15a9, 0x2732, 0x36bb,
	0xce4c, 0xdfc5, 0xed5e, 0xfcd7, 0x8868, 0x99e1, 0xab7a, 0xbaf3,
	0x5285, 0x430c, 0x7197, 0x601e, 0x14a1, 0x0528, 0x37b3, 0x263a,
	0xdecd, 0xcf44, 0xfddf, 0xec56, 0x98e9, 0x8960, 0xbbfb, 0xaa72,
	0x6306, 0x728f, 0x4014, 0x519d, 0x2522, 0x34ab, 0x0630, 0x17b9,
	0xef4e, 0xfec7, 0xcc5c, 0xddd5, 0xa96a, 0xb8e3, 0x8a78, 0x9bf1,
	0x7387, 0x620e, 0x5095, 0x411c, 0x35a3, 0x242a, 0x16b1, 0x0738,
	0xffcf, 0xee46, 0xdcdd, 0xcd54, 0xb9eb, 0xa862, 0x9af9, 0x8b70,
	0x8408, 0x9581, 0xa71a, 0xb693, 0xc22c, 0xd3a5, 0xe13e, 0xf0b7,
	0x0840, 0x19c9, 0x2b52, 0x3adb, 0x4e64, 0x5fed, 0x6d76, 0x7cff,
	0x9489, 0x8500, 0xb79b, 0xa612, 0xd2ad, 0xc324, 0xf1bf, 0xe036,
	0x18c1, 0x0948, 0x3bd3, 0x2a5a, 0x5ee5, 0x4f6c, 0x7df7, 0x6c7e,
	0xa50a, 0xb483, 0x8618, 0x9791, 0xe32e, 0xf2a7, 0xc03c, 0xd1b5,
	0x2942, 0x38cb, 0x0a50, 0x1bd9, 0x6f66, 0x7eef, 0x4c74, 0x5dfd,
	0xb58b, 0xa402, 0x9699, 0x8710, 0xf3af, 0xe226, 0xd0bd, 0xc134,
	0x39c3, 0x284a, 0x1ad1, 0x0b58, 0x7fe7, 0x6e6e, 0x5cf5, 0x4d7c,
	0xc60c, 0xd785, 0xe51e, 0xf497, 0x8028, 0x91a1, 0xa33a, 0xb2b3,
	0x4a44, 0x5bcd, 0x6956, 0x78df, 0x0c60, 0x1de9, 0x2f72, 0x3efb,
	0xd68d, 0xc704, 0xf59f, 0xe416, 0x90a9, 0x8120, 0xb3bb, 0xa232,
	0x5ac5, 0x4b4c, 0x79d7, 0x685e, 0x1ce1, 0x0d68, 0x3ff3, 0x2e7a,
	0xe70e, 0xf687, 0xc41c, 0xd595, 0xa12a, 0xb0a3, 0x8238, 0x93b1,
	0x6b46, 0x7acf, 0x4854, 0x59dd, 0x2d62, 0x3ceb, 0x0e70, 0x1ff9,
	0xf78f, 0xe606, 0xd49d, 0xc514, 0xb1ab, 0xa022, 0x92b9, 0x8330,
	0x7bc7, 0x6a4e, 0x58d5, 0x495c, 0x3de3, 0x2c6a, 0x1ef1, 0x0f78
};



/*safety CRC */
DWORD CrcmTab[2][256] = {
	{
		0x00000000L,	0x1942B361L,	0x328566C2L,	0x2BC7D5A3L,	0x650ACD84L,	0x7C487EE5L,	0x578FAB46L,	0x4ECD1827L,
			0xCA159B08L,	0xD3572869L,	0xF890FDCAL,	0xE1D24EABL,	0xAF1F568CL,	0xB65DE5EDL,	0x9D9A304EL,	0x84D8832FL,
			0x18CE5601L,	0x018CE560L,	0x2A4B30C3L,	0x330983A2L,	0x7DC49B85L,	0x648628E4L,	0x4F41FD47L,	0x56034E26L,
			0xD2DBCD09L,	0xCB997E68L,	0xE05EABCBL,	0xF91C18AAL,	0xB7D1008DL,	0xAE93B3ECL,	0x8554664FL,	0x9C16D52EL,
			0x319CAC02L,	0x28DE1F63L,	0x0319CAC0L,	0x1A5B79A1L,	0x54966186L,	0x4DD4D2E7L,	0x66130744L,	0x7F51B425L,
			0xFB89370AL,	0xE2CB846BL,	0xC90C51C8L,	0xD04EE2A9L,	0x9E83FA8EL,	0x87C149EFL,	0xAC069C4CL,	0xB5442F2DL,
			0x2952FA03L,	0x30104962L,	0x1BD79CC1L,	0x02952FA0L,	0x4C583787L,	0x551A84E6L,	0x7EDD5145L,	0x679FE224L,
			0xE347610BL,	0xFA05D26AL,	0xD1C207C9L,	0xC880B4A8L,	0x864DAC8FL,	0x9F0F1FEEL,	0xB4C8CA4DL,	0xAD8A792CL,
			0x63395804L,	0x7A7BEB65L,	0x51BC3EC6L,	0x48FE8DA7L,	0x06339580L,	0x1F7126E1L,	0x34B6F342L,	0x2DF44023L,
			0xA92CC30CL,	0xB06E706DL,	0x9BA9A5CEL,	0x82EB16AFL,	0xCC260E88L,	0xD564BDE9L,	0xFEA3684AL,	0xE7E1DB2BL,
			0x7BF70E05L,	0x62B5BD64L,	0x497268C7L,	0x5030DBA6L,	0x1EFDC381L,	0x07BF70E0L,	0x2C78A543L,	0x353A1622L,
			0xB1E2950DL,	0xA8A0266CL,	0x8367F3CFL,	0x9A2540AEL,	0xD4E85889L,	0xCDAAEBE8L,	0xE66D3E4BL,	0xFF2F8D2AL,
			0x52A5F406L,	0x4BE74767L,	0x602092C4L,	0x796221A5L,	0x37AF3982L,	0x2EED8AE3L,	0x052A5F40L,	0x1C68EC21L,
			0x98B06F0EL,	0x81F2DC6FL,	0xAA3509CCL,	0xB377BAADL,	0xFDBAA28AL,	0xE4F811EBL,	0xCF3FC448L,	0xD67D7729L,
			0x4A6BA207L,	0x53291166L,	0x78EEC4C5L,	0x61AC77A4L,	0x2F616F83L,	0x3623DCE2L,	0x1DE40941L,	0x04A6BA20L,
			0x807E390FL,	0x993C8A6EL,	0xB2FB5FCDL,	0xABB9ECACL,	0xE574F48BL,	0xFC3647EAL,	0xD7F19249L,	0xCEB32128L,
			0xC672B008L,	0xDF300369L,	0xF4F7D6CAL,	0xEDB565ABL,	0xA3787D8CL,	0xBA3ACEEDL,	0x91FD1B4EL,	0x88BFA82FL,
			0x0C672B00L,	0x15259861L,	0x3EE24DC2L,	0x27A0FEA3L,	0x696DE684L,	0x702F55E5L,	0x5BE88046L,	0x42AA3327L,
			0xDEBCE609L,	0xC7FE5568L,	0xEC3980CBL,	0xF57B33AAL,	0xBBB62B8DL,	0xA2F498ECL,	0x89334D4FL,	0x9071FE2EL,
			0x14A97D01L,	0x0DEBCE60L,	0x262C1BC3L,	0x3F6EA8A2L,	0x71A3B085L,	0x68E103E4L,	0x4326D647L,	0x5A646526L,
			0xF7EE1C0AL,	0xEEACAF6BL,	0xC56B7AC8L,	0xDC29C9A9L,	0x92E4D18EL,	0x8BA662EFL,	0xA061B74CL,	0xB923042DL,
			0x3DFB8702L,	0x24B93463L,	0x0F7EE1C0L,	0x163C52A1L,	0x58F14A86L,	0x41B3F9E7L,	0x6A742C44L,	0x73369F25L,
			0xEF204A0BL,	0xF662F96AL,	0xDDA52CC9L,	0xC4E79FA8L,	0x8A2A878FL,	0x936834EEL,	0xB8AFE14DL,	0xA1ED522CL,
			0x2535D103L,	0x3C776262L,	0x17B0B7C1L,	0x0EF204A0L,	0x403F1C87L,	0x597DAFE6L,	0x72BA7A45L,	0x6BF8C924L,
			0xA54BE80CL,	0xBC095B6DL,	0x97CE8ECEL,	0x8E8C3DAFL,	0xC0412588L,	0xD90396E9L,	0xF2C4434AL,	0xEB86F02BL,
			0x6F5E7304L,	0x761CC065L,	0x5DDB15C6L,	0x4499A6A7L,	0x0A54BE80L,	0x13160DE1L,	0x38D1D842L,	0x21936B23L,
			0xBD85BE0DL,	0xA4C70D6CL,	0x8F00D8CFL,	0x96426BAEL,	0xD88F7389L,	0xC1CDC0E8L,	0xEA0A154BL,	0xF348A62AL,
			0x77902505L,	0x6ED29664L,	0x451543C7L,	0x5C57F0A6L,	0x129AE881L,	0x0BD85BE0L,	0x201F8E43L,	0x395D3D22L,
			0x94D7440EL,	0x8D95F76FL,	0xA65222CCL,	0xBF1091ADL,	0xF1DD898AL,	0xE89F3AEBL,	0xC358EF48L,	0xDA1A5C29L,
			0x5EC2DF06L,	0x47806C67L,	0x6C47B9C4L,	0x75050AA5L,	0x3BC81282L,	0x228AA1E3L,	0x094D7440L,	0x100FC721L,
			0x8C19120FL,	0x955BA16EL,	0xBE9C74CDL,	0xA7DEC7ACL,	0xE913DF8BL,	0xF0516CEAL,	0xDB96B949L,	0xC2D40A28L,
			0x460C8907L,	0x5F4E3A66L,	0x7489EFC5L,	0x6DCB5CA4L,	0x23064483L,	0x3A44F7E2L,	0x11832241L,	0x08C19120L
	},
	{
		0x00000000L,	0x1EF09C7EL,	0x3DE138FCL,	0x2311A482L,	0x7BC271F8L,	0x6532ED86L,	0x46234904L,	0x58D3D57AL,
			0xF784E3F0L,	0xE9747F8EL,	0xCA65DB0CL,	0xD4954772L,	0x8C469208L,	0x92B60E76L,	0xB1A7AAF4L,	0xAF57368AL,
			0xFF048983L,	0xE1F415FDL,	0xC2E5B17FL,	0xDC152D01L,	0x84C6F87BL,	0x9A366405L,	0xB927C087L,	0xA7D75CF9L,
			0x08806A73L,	0x1670F60DL,	0x3561528FL,	0x2B91CEF1L,	0x73421B8BL,	0x6DB287F5L,	0x4EA32377L,	0x5053BF09L,
			0xEE045D65L,	0xF0F4C11BL,	0xD3E56599L,	0xCD15F9E7L,	0x95C62C9DL,	0x8B36B0E3L,	0xA8271461L,	0xB6D7881FL,
			0x1980BE95L,	0x077022EBL,	0x24618669L,	0x3A911A17L,	0x6242CF6DL,	0x7CB25313L,	0x5FA3F791L,	0x41536BEFL,
			0x1100D4E6L,	0x0FF04898L,	0x2CE1EC1AL,	0x32117064L,	0x6AC2A51EL,	0x74323960L,	0x57239DE2L,	0x49D3019CL,
			0xE6843716L,	0xF874AB68L,	0xDB650FEAL,	0xC5959394L,	0x9D4646EEL,	0x83B6DA90L,	0xA0A77E12L,	0xBE57E26CL,
			0xCC05F4A9L,	0xD2F568D7L,	0xF1E4CC55L,	0xEF14502BL,	0xB7C78551L,	0xA937192FL,	0x8A26BDADL,	0x94D621D3L,
			0x3B811759L,	0x25718B27L,	0x06602FA5L,	0x1890B3DBL,	0x404366A1L,	0x5EB3FADFL,	0x7DA25E5DL,	0x6352C223L,
			0x33017D2AL,	0x2DF1E154L,	0x0EE045D6L,	0x1010D9A8L,	0x48C30CD2L,	0x563390ACL,	0x7522342EL,	0x6BD2A850L,
			0xC4859EDAL,	0xDA7502A4L,	0xF964A626L,	0xE7943A58L,	0xBF47EF22L,	0xA1B7735CL,	0x82A6D7DEL,	0x9C564BA0L,
			0x2201A9CCL,	0x3CF135B2L,	0x1FE09130L,	0x01100D4EL,	0x59C3D834L,	0x4733444AL,	0x6422E0C8L,	0x7AD27CB6L,
			0xD5854A3CL,	0xCB75D642L,	0xE86472C0L,	0xF694EEBEL,	0xAE473BC4L,	0xB0B7A7BAL,	0x93A60338L,	0x8D569F46L,
			0xDD05204FL,	0xC3F5BC31L,	0xE0E418B3L,	0xFE1484CDL,	0xA6C751B7L,	0xB837CDC9L,	0x9B26694BL,	0x85D6F535L,
			0x2A81C3BFL,	0x34715FC1L,	0x1760FB43L,	0x0990673DL,	0x5143B247L,	0x4FB32E39L,	0x6CA28ABBL,	0x725216C5L,
			0x8806A731L,	0x96F63B4FL,	0xB5E79FCDL,	0xAB1703B3L,	0xF3C4D6C9L,	0xED344AB7L,	0xCE25EE35L,	0xD0D5724BL,
			0x7F8244C1L,	0x6172D8BFL,	0x42637C3DL,	0x5C93E043L,	0x04403539L,	0x1AB0A947L,	0x39A10DC5L,	0x275191BBL,
			0x77022EB2L,	0x69F2B2CCL,	0x4AE3164EL,	0x54138A30L,	0x0CC05F4AL,	0x1230C334L,	0x312167B6L,	0x2FD1FBC8L,
			0x8086CD42L,	0x9E76513CL,	0xBD67F5BEL,	0xA39769C0L,	0xFB44BCBAL,	0xE5B420C4L,	0xC6A58446L,	0xD8551838L,
			0x6602FA54L,	0x78F2662AL,	0x5BE3C2A8L,	0x45135ED6L,	0x1DC08BACL,	0x033017D2L,	0x2021B350L,	0x3ED12F2EL,
			0x918619A4L,	0x8F7685DAL,	0xAC672158L,	0xB297BD26L,	0xEA44685CL,	0xF4B4F422L,	0xD7A550A0L,	0xC955CCDEL,
			0x990673D7L,	0x87F6EFA9L,	0xA4E74B2BL,	0xBA17D755L,	0xE2C4022FL,	0xFC349E51L,	0xDF253AD3L,	0xC1D5A6ADL,
			0x6E829027L,	0x70720C59L,	0x5363A8DBL,	0x4D9334A5L,	0x1540E1DFL,	0x0BB07DA1L,	0x28A1D923L,	0x3651455DL,
			0x44035398L,	0x5AF3CFE6L,	0x79E26B64L,	0x6712F71AL,	0x3FC12260L,	0x2131BE1EL,	0x02201A9CL,	0x1CD086E2L,
			0xB387B068L,	0xAD772C16L,	0x8E668894L,	0x909614EAL,	0xC845C190L,	0xD6B55DEEL,	0xF5A4F96CL,	0xEB546512L,
			0xBB07DA1BL,	0xA5F74665L,	0x86E6E2E7L,	0x98167E99L,	0xC0C5ABE3L,	0xDE35379DL,	0xFD24931FL,	0xE3D40F61L,
			0x4C8339EBL,	0x5273A595L,	0x71620117L,	0x6F929D69L,	0x37414813L,	0x29B1D46DL,	0x0AA070EFL,	0x1450EC91L,
			0xAA070EFDL,	0xB4F79283L,	0x97E63601L,	0x8916AA7FL,	0xD1C57F05L,	0xCF35E37BL,	0xEC2447F9L,	0xF2D4DB87L,
			0x5D83ED0DL,	0x43737173L,	0x6062D5F1L,	0x7E92498FL,	0x26419CF5L,	0x38B1008BL,	0x1BA0A409L,	0x05503877L,
			0x5503877EL,	0x4BF31B00L,	0x68E2BF82L,	0x761223FCL,	0x2EC1F686L,	0x30316AF8L,	0x1320CE7AL,	0x0DD05204L,
			0xA287648EL,	0xBC77F8F0L,	0x9F665C72L,	0x8196C00CL,	0xD9451576L,	0xC7B58908L,	0xE4A42D8AL,	0xFA54B1F4L
		}
};

const BYTE Reflected_Byte[] = {
	0x00,	0x80,	0x40,	0xC0,	0x20,	0xA0,	0x60,	0xE0,
	0x10,	0x90,	0x50,	0xD0,	0x30,	0xB0,	0x70,	0xF0,
	0x08,	0x88,	0x48,	0xC8,	0x28,	0xA8,	0x68,	0xE8,
	0x18,	0x98,	0x58,	0xD8,	0x38,	0xB8,	0x78,	0xF8,
	0x04,	0x84,	0x44,	0xC4,	0x24,	0xA4,	0x64,	0xE4,
	0x14,	0x94,	0x54,	0xD4,	0x34,	0xB4,	0x74,	0xF4,
	0x0C,	0x8C,	0x4C,	0xCC,	0x2C,	0xAC,	0x6C,	0xEC,
	0x1C,	0x9C,	0x5C,	0xDC,	0x3C,	0xBC,	0x7C,	0xFC,
	0x02,	0x82,	0x42,	0xC2,	0x22,	0xA2,	0x62,	0xE2,
	0x12,	0x92,	0x52,	0xD2,	0x32,	0xB2,	0x72,	0xF2,
	0x0A,	0x8A,	0x4A,	0xCA,	0x2A,	0xAA,	0x6A,	0xEA,
	0x1A,	0x9A,	0x5A,	0xDA,	0x3A,	0xBA,	0x7A,	0xFA,
	0x06,	0x86,	0x46,	0xC6,	0x26,	0xA6,	0x66,	0xE6,
	0x16,	0x96,	0x56,	0xD6,	0x36,	0xB6,	0x76,	0xF6,
	0x0E,	0x8E,	0x4E,	0xCE,	0x2E,	0xAE,	0x6E,	0xEE,
	0x1E,	0x9E,	0x5E,	0xDE,	0x3E,	0xBE,	0x7E,	0xFE,
	0x01,	0x81,	0x41,	0xC1,	0x21,	0xA1,	0x61,	0xE1,
	0x11,	0x91,	0x51,	0xD1,	0x31,	0xB1,	0x71,	0xF1,
	0x09,	0x89,	0x49,	0xC9,	0x29,	0xA9,	0x69,	0xE9,
	0x19,	0x99,	0x59,	0xD9,	0x39,	0xB9,	0x79,	0xF9,
	0x05,	0x85,	0x45,	0xC5,	0x25,	0xA5,	0x65,	0xE5,
	0x15,	0x95,	0x55,	0xD5,	0x35,	0xB5,	0x75,	0xF5,
	0x0D,	0x8D,	0x4D,	0xCD,	0x2D,	0xAD,	0x6D,	0xED,
	0x1D,	0x9D,	0x5D,	0xDD,	0x3D,	0xBD,	0x7D,	0xFD,
	0x03,	0x83,	0x43,	0xC3,	0x23,	0xA3,	0x63,	0xE3,
	0x13,	0x93,	0x53,	0xD3,	0x33,	0xB3,	0x73,	0xF3,
	0x0B,	0x8B,	0x4B,	0xCB,	0x2B,	0xAB,	0x6B,	0xEB,
	0x1B,	0x9B,	0x5B,	0xDB,	0x3B,	0xBB,	0x7B,	0xFB,
	0x07,	0x87,	0x47,	0xC7,	0x27,	0xA7,	0x67,	0xE7,
	0x17,	0x97,	0x57,	0xD7,	0x37,	0xB7,	0x77,	0xF7,
	0x0F,	0x8F,	0x4F,	0xCF,	0x2F,	0xAF,	0x6F,	0xEF,
	0x1F,	0x9F,	0x5F,	0xDF,	0x3F,	0xBF,	0x7F,	0xFF
};

const WORD CRC16TAB[] = {
	0x0000,  0x2314,  0x4628,  0x653C,  0x8C50,  0xAF44,  0xCA78,  0xE96C,
	0x881,   0x2B95,  0x4EA9,  0x6DBD,  0x84D1,  0xA7C5,  0xC2F9,  0xE1ED,
	0x1102,  0x3216,  0x572A,  0x743E,  0x9D52,  0xBE46,  0xDB7A,  0xF86E,
	0x1983,  0x3A97,  0x5FAB,  0x7CBF,  0x95D3,  0xB6C7,  0xD3FB,  0xF0EF,
	0x2204,  0x110,   0x642C,  0x4738,  0xAE54,  0x8D40,  0xE87C,  0xCB68,
	0x2A85,  0x991,   0x6CAD,  0x4FB9,  0xA6D5,  0x85C1,  0xE0FD,  0xC3E9,
	0x3306,  0x1012,  0x752E,  0x563A,  0xBF56,  0x9C42,  0xF97E,  0xDA6A,
	0x3B87,  0x1893,  0x7DAF,  0x5EBB,  0xB7D7,  0x94C3,  0xF1FF,  0xD2EB,
	0x4408,  0x671C,  0x220,   0x2134,  0xC858,  0xEB4C,  0x8E70,  0xAD64,
	0x4C89,  0x6F9D,  0xAA1,   0x29B5,  0xC0D9,  0xE3CD,  0x86F1,  0xA5E5,
	0x550A,  0x761E,  0x1322,  0x3036,  0xD95A,  0xFA4E,  0x9F72,  0xBC66,
	0x5D8B,  0x7E9F,  0x1BA3,  0x38B7,  0xD1DB,  0xF2CF,  0x97F3,  0xB4E7,
	0x660C,  0x4518,  0x2024,  0x330,   0xEA5C,  0xC948,  0xAC74,  0x8F60,
	0x6E8D,  0x4D99,  0x28A5,  0xBB1,   0xE2DD,  0xC1C9,  0xA4F5,  0x87E1,
	0x770E,  0x541A,  0x3126,  0x1232,  0xFB5E,  0xD84A,  0xBD76,  0x9E62,
	0x7F8F,  0x5C9B,  0x39A7,  0x1AB3,  0xF3DF,  0xD0CB,  0xB5F7,  0x96E3,
	0x8810,  0xAB04,  0xCE38,  0xED2C,  0x440,   0x2754,  0x4268,  0x617C,
	0x8091,  0xA385,  0xC6B9,  0xE5AD,  0xCC1,   0x2FD5,  0x4AE9,  0x69FD,
	0x9912,  0xBA06,  0xDF3A,  0xFC2E,  0x1542,  0x3656,  0x536A,  0x707E,
	0x9193,  0xB287,  0xD7BB,  0xF4AF,  0x1DC3,  0x3ED7,  0x5BEB,  0x78FF,
	0xAA14,  0x8900,  0xEC3C,  0xCF28,  0x2644,  0x550,   0x606C,  0x4378,
	0xA295,  0x8181,  0xE4BD,  0xC7A9,  0x2EC5,  0xDD1,   0x68ED,  0x4BF9,
	0xBB16,  0x9802,  0xFD3E,  0xDE2A,  0x3746,  0x1452,  0x716E,  0x527A,
	0xB397,  0x9083,  0xF5BF,  0xD6AB,  0x3FC7,  0x1CD3,  0x79EF,  0x5AFB,
	0xCC18,  0xEF0C,  0x8A30,  0xA924,  0x4048,  0x635C,  0x660,   0x2574,
	0xC499,  0xE78D,  0x82B1,  0xA1A5,  0x48C9,  0x6BDD,  0xEE1,   0x2DF5,
	0xDD1A,  0xFE0E,  0x9B32,  0xB826,  0x514A,  0x725E,  0x1762,  0x3476,
	0xD59B,  0xF68F,  0x93B3,  0xB0A7,  0x59CB,  0x7ADF,  0x1FE3,  0x3CF7,
	0xEE1C,  0xCD08,  0xA834,  0x8B20,  0x624C,  0x4158,  0x2464,  0x770,
	0xE69D,  0xC589,  0xA0B5,  0x83A1,  0x6ACD,  0x49D9,  0x2CE5,  0xFF1,
	0xFF1E,  0xDC0A,  0xB936,  0x9A22,  0x734E,  0x505A,  0x3566,  0x1672,
	0xF79F,  0xD48B,  0xB1B7,  0x92A3,  0x7BCF,  0x58DB,  0x3DE7,  0x1EF3	
};

/*CRC16-CCITT x16+x12+x5+1 1021 ISO HDLC, ITU X.25, V.34/V.41/V.42, PPP-FCS*/

/******************************************************************************
函数名：   GetCRC16_CCITT
功能描述： 计算给定长度数据的16位CRC(1021)
输入参数： const unsigned char *pData, DWORD dwLength,WORD w16CRCValue
输出参数： 无
返回值：   CRC校验和
******************************************************************************/
WORD GetCRC16_CCITT(const unsigned char *pData, DWORD dwLength,WORD w16CRCValue)
{
	ASSERT(NULL != pData);
	ASSERT(0 != dwLength);
	ASSERT(0xFFFF == w16CRCValue);

	while(dwLength--)
	{
		w16CRCValue = ( w16CRCValue >> 8 )^crc16_ccitt_tableL[(w16CRCValue^*pData++)&0xFF];
	}

	return ~w16CRCValue;
} 

/******************************************************************************
函数名：   IsRightCRC16_CCITT 
功能描述： 计算给定长度数据的16位CRC(1021)
输入参数： const unsigned char *pData, DWORD dwLength,WORD w16CRCValue
输出参数： 无 
返回值：   CRC校验和
******************************************************************************/
BOOL IsRightCRC16_CCITT(const unsigned char *pData, DWORD dwLength,WORD w16CRCValue)
{
	ASSERT(NULL != pData);
	ASSERT(0 != dwLength);
	ASSERT(0xFFFF == w16CRCValue);

	while(dwLength--)
	{
		w16CRCValue = ( w16CRCValue >> 8 )^crc16_ccitt_tableL[(w16CRCValue^*pData++)&0xFF];
	}

	return (0xF0B8 == w16CRCValue);
} 

/******************************************************************************
函数名：   CheckCRC16_CCITT 
功能描述： 16位CRC校验(1021)
输入参数： const LPBYTE pData,DWORD dwLength,WORD w16CRCValue,WORD w16CheckNum
输出参数： 无
返回值：   TRUE-校验成功 FALSE-校验失败
******************************************************************************/
BOOL CheckCRC16_CCITT(const LPBYTE pData,DWORD dwLength,WORD w16CRCValue,WORD w16CheckNum)
{
	ASSERT(NULL != pData);
	ASSERT(0 != dwLength);

	/*初始校验和0xFFFF*/
	if(0xFFFF != w16CRCValue)
	{
		return FALSE;
	}
	/*CRC校验和*/
	if(FALSE != IsRightCRC16_CCITT(pData,dwLength,w16CRCValue))
	{
		return TRUE;
	}

	return FALSE;
}

/******************************************************************************
函数名：   CheckCRC16 
功能描述： 16位CRC校验
输入参数： const LPBYTE pData,DWORD dwLength,WORD w16CRC,WORD w16CRCValue,WORD w16CheckNum
输出参数： 无 
返回值：   TRUE-校验成功 FALSE-校验失败
******************************************************************************/
BOOL CheckCRC16(const LPBYTE pData,DWORD dwLength,WORD w16CRC,WORD w16CRCValue,WORD w16CheckNum)
{
	ASSERT(NULL != pData);
	ASSERT(0 != dwLength);

	/*CRC16-CCITT x16+x12+x5+1 1021 ISO HDLC, ITU X.25, V.34/V.41/V.42, PPP-FCS*/
	if(0x1021 == w16CRC)
	{
		if(FALSE != CheckCRC16_CCITT(pData,dwLength,w16CRCValue,w16CheckNum))
		{
			return TRUE;
		}
	}

	return FALSE;
}

/******************************************************************************
函数名：   CheckCRC32 
功能描述： 32位CRC校验
输入参数： const LPBYTE pData,DWORD dwLength,DWORD dw32CRC,DWORD dw32CRCValue,DWORD dw32CheckNum
输出参数： 无 
返回值：   TRUE-校验成功 FALSE-校验失败
******************************************************************************/
BOOL CheckCRC32(const LPBYTE pData,DWORD dwLength,DWORD dw32CRC,DWORD dw32CRCValue,DWORD dw32CheckNum)
{
	ASSERT(NULL != pData);
	/*
	待实现
	*/
	return TRUE;
}



/*******************************************************************************
** 函数名：FCS16
** 功能描述：采用标准CRC-CCITT算法计算FCS-16（参考Subset-098 V1.0.0 6.4.5.1.5）
** 输入参数：pData:  指向待求校验的数据 iLen:   原始数据字节长度
** 输出参数：无
** 返回值：16位CRC
*******************************************************************************/
WORD FCS16(BYTE *pbtBuf, DWORD dwLen)
{
	WORD fcs=0xFFFF;				/* initial FCS Value */
	DWORD d, i, k;
	for (i=0; i<dwLen; i++)
	{
		d = *pbtBuf++ << 8;
		for (k=0; k<8; k++)
		{
			if ((fcs ^ d) & 0x8000)
			{
				fcs = (fcs << 1) ^ 0x1021;	/* x16 + x12 + x5 + 1 */
			}
			else
			{
				fcs = (fcs << 1);
			}
			d <<= 1;
		}
	}
	return(fcs&0xFFFF);   
}
#endif

/* 高位在前 */
/* crc[0] = HIBYTE(crc) */
/* crc[1] = LOBYTE(crc) */
/*******************************************************************************
** 函数名：GetCCITTCrcH
** 功能描述：采用标准CRC-CCITT算法计算FCS-16（参考Subset-098 V1.0.0 6.4.5.1.5）
** 输入参数：pData:  指向待求校验的数据 iLen:   原始数据字节长度
** 输出参数：无
** 返回值：16位CRC
*******************************************************************************/
WORD GetCCITTCrcH(WORD crcInit, BYTE *pBuf, DWORD dwLen)  /*%RELAX<MISRA_16_7>*/
{
	WORD dwCrc = crcInit;
	while(dwLen--) 
	{
		dwCrc = (dwCrc << 8) ^ crc16_ccitt_tableH[((dwCrc >> 8) ^ *pBuf++) & 0xFF]; /*%RELAX<MISRA_10_1>*/  /*%RELAX<MISRA_12_13>*/  /*%RELAX<MISRA_17_4>*/
	}
	return( dwCrc & 0xFFFF ); /*%RELAX<MISRA_10_1>*/
}
#if 0
/* 低位在前 */
/* crc[0] = LOBYTE(crc) */
/* crc[1] = HIBYTE(crc) */
/*******************************************************************************
** 函数名：GetCCITTCrcL
** 功能描述：采用标准CRC-CCITT算法计算FCS-16
** 输入参数：pData:  指向待求校验的数据 iLen:   原始数据字节长度
** 输出参数：无
** 返回值：16位CRC
*******************************************************************************/
WORD GetCCITTCrcL(WORD crcInit, BYTE *pBuf, DWORD dwLen) 
{
	WORD dwCrc = crcInit; 
	while (dwLen--) 
	{
		dwCrc = (dwCrc >> 8) ^ crc16_ccitt_tableL[(dwCrc ^ (*pBuf++)) & 0xff];
	}

	return( dwCrc & 0xFFFF );
}

/*fast crc 32 compute */
DWORD SafetyCRCCompute (BYTE *Ptr, INT size, BYTE chan)
{
	INT i;
	DWORD Result;
	DWORD* dwCrcmTab;

	if((Ptr==NULL) || (chan>1) ) 
	{
		return 0;
	}

	Result = 0;
	dwCrcmTab = (DWORD*)(CrcmTab[chan]);

	for (i = 0; i < size; i++)
	{
		Result = ((Result >> 8)&0x00FFFFFFL) ^ dwCrcmTab[(BYTE)((Result ^ Reflected_Byte[*Ptr]) & 0xFF)];
		Ptr++;
	}

	return Result;
}

/*fast crc 32 compute */
DWORD AlstomCRC32(BYTE *buf, INT len, INT chan)
{
	INT i = 0;
	DWORD result = 0;
	DWORD temp = 0;
	DWORD* dwCrcmTab;

	if((buf==NULL)|| (chan>1))
	{
		return 0;    
	}

	dwCrcmTab = (DWORD*)(CrcmTab[chan]);
	for (i=0; i<len; i++)
	{		
		temp   = dwCrcmTab[ (result ^ Reflected_Byte[*buf]) & 0xFF ];
		result = temp ^ ( (result >> 8) & 0x00FFFFFFL );        
		buf++;
	}          

	return result;
}

/*fast crc 16 compute */
WORD AlstomFastCRC16(BYTE *buf, WORD len)
{
	INT i = 0;
	WORD result = 0, temp = 0;

	for(i=0; i<len; i++)
	{
		temp   = CRC16TAB[(result ^ *buf ) & 0xFF];
		result = temp ^ ((result >> 8) & 0x00ff);
		/*      temp = result;
		result = CRC16TAB[(DWORD)((temp) ^ (((WORD)*buf) & 0xFF)) & 0xFF];
		temp = ((temp >> 8) & 0xffff);
		result ^= temp;
		*/        
		buf++;
	}

	return result;
}

/*------------------------------------------------------------------------------------------

Function Name: CheckMesgCRC
Description  : Public Function for reception process to check message's CRC

-------------------------------------------------------------------------------------------*/
BOOL CheckMesgCRC(BYTE* DataBuf,WORD DataSize)
{
	WORD MesgCRC,LEN;

	LEN = DataSize-2;
	memcpy(&MesgCRC, DataBuf+LEN, 2);
	return  ( MesgCRC == AlstomFastCRC16(DataBuf, LEN) );
}



/*------------------------------------------------------------------------------------

NON SAFETY CRC COMPUTE

--------------------------------------------------------------------------------------*/

/* Based on the polynomial x^16+x^11+x^4+1 and initial value is 0 */
/* ALSTOM_CRC_MASK = 0x8810 */
WORD ComputeMesgCRC(BYTE* Addr, WORD Len)
{
	BYTE BitCount;
	WORD ActByte;
	WORD CompCRC;

	CompCRC = 0;
	while (Len > 0)
	{
		ActByte = (WORD)(*Addr);
		for (BitCount = 8; BitCount > 0; BitCount--)
		{
			if ((ActByte ^ CompCRC) & 1)
			{
				CompCRC = (CompCRC >> 1) ^ ALSTOM_CRC_MASK;
			}
			else 
			{
				CompCRC >>= 1;
			}
			ActByte >>= 1;
		}
		Addr++;
		Len--;
	}
	return(CompCRC);
}

/* Based on the polynomial x^32+x^26+x^23+x^22+x^16+x^12+x^11+x^10+x^8+x^7+x^5+x^4+x^2+x+1 and initial value is 0 */
DWORD Get_CCITT_CRC32( const BYTE *pBuf, INT iLen )
{
	INT i, j;
	DWORD ch, crc=0;

	for( i=0; i<iLen; i++ )
	{
		ch = pBuf[i];
		ch <<= 24;
		for( j=0; j<8; j++)
		{
			if((crc ^ ch) & 0x80000000L)
			{
				crc=(crc<<1)^0x04C11DB7L;
			}
			else 
			{
				crc <<= 1;
			}
			ch<<=1;
		}
	}

	return crc;
}

DWORD Get_CRC32( const BYTE *pBuf, INT iLen,DWORD dwPolynomial)
{
	INT i, j;
	DWORD ch, crc=0;

	for( i=0; i<iLen; i++ )
	{
		ch = pBuf[i];
		ch <<= 24;
		for( j=0; j<8; j++)
		{
			if((crc ^ ch) & 0x80000000L) 
			{
				crc=(crc<<1)^dwPolynomial;
			}
			else 
			{
				crc <<= 1;
			}
			ch<<=1;
		}
	}

	return crc;
}
#endif

